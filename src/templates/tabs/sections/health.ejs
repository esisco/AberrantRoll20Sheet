<%
// Armor configuration
const armorSlots = [
    { id: 1, name: 'Mega_Stamina' },
    { id: 2, name: 'Eufiber' }
];
// Additional numbered armor slots (3-11)
for (let i = 3; i <= 11; i++) {
    armorSlots.push({ id: i, name: null });
}

// Health injury types
const injuryTypes = [
    { name: 'Bruised', repeatingClass: 'bruisedhealth' },
    { name: 'Hurt', repeatingClass: 'hurthealth' },
    { name: 'Injured', repeatingClass: 'hurthealth' },
    { name: 'Wounded', repeatingClass: 'woundedhealth' },
    { name: 'Maimed', repeatingClass: 'maimedhealth' },
    { name: 'Crippled', repeatingClass: 'crippledhealth' },
    { name: 'Incapacitated', repeatingClass: 'incapacitatedhealth' }
];

// Wound options for select dropdowns
const woundOptions = ['', '/', 'X', '*'];
-%>
        <div class='health'>
			<h2>Health</h2>
    		<div class="dual_col">
                <div class="col">
				    <h3 class="category-title">Soak</h3>
                    <table class="movement-table">
                        <thead>
                            <tr>
                                <th class="item w100">Armor</th>
                                <th class="item w50">Bashing</th>
                                <th class="item w50">Lethal</th>
                                <th class="item w70">Aggravated</th>
                                <th class="item w50">Penalty</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="item w100">Natural Soak</td>
                                <td class="item w50"><input type='text' class="st" name='attr_Natural_Bashing_Soak' value=1 min=1 /></td>
                                <td class="item w50"><input type='text' class="st" name='attr_Natural_Lethal_Soak' value=0 min=0 /></td>
                                <td class="item w70"><input type='text' class="st" name='attr_Natural_Aggravated_Soak' value=0 min=0 /></td>
                                <td class="item w50"><input type='text' class="st" name='attr_Natural_Aggravated_Penalty' value=0 readonly /></td>
                            </tr>
                            <% armorSlots.forEach(armor => { -%>
                            <tr>
                                <td class="item w100"><% if (armor.name) { %><%= armor.name %><% } else { %><input type='text' class="st" name='attr_Armor<%= armor.id %>_Name'/><% } %></td>
                                <td class="item w50"><input type='text' class="st" name='attr_Armor<%= armor.id %>_Bashing_Soak' value=0 min=0 /></td>
                                <td class="item w50"><input type='text' class="st" name='attr_Armor<%= armor.id %>_Lethal_Soak' value=0 min=0 /></td>
                                <td class="item w70"><input type='text' class="st" name='attr_Armor<%= armor.id %>_Aggravated_Soak' value=0 min=0 /></td>
                                <td class="item w50"><input type='text' class="st" name='attr_Armor<%= armor.id %>_Penalty' value=0 min=0<% if (armor.id === 1) { %> readonly<% } %> /></td>
                            </tr>
                            <% }); -%>
                            <tr>
                                <td class="item w100">Total</td>
                                <td class="item w50" ><input type='text' class="st" name='attr_Bashing_Soak' value="@{Natural_Bashing_Soak}<% armorSlots.forEach(a => { %>+@{Armor<%= a.id %>_Bashing_Soak}<% }); %>" disabled/></td>
                                <td class="item w50" ><input type='text' class="st" name='attr_Lethal_Soak' value="@{Natural_Lethal_Soak}<% armorSlots.forEach(a => { %>+@{Armor<%= a.id %>_Lethal_Soak}<% }); %>" disabled/></td>
                                <td class="item w70" ><input type='text' class="st" name='attr_Aggravated_Soak' value="@{Natural_Aggravated_Soak}<% armorSlots.forEach(a => { %>+@{Armor<%= a.id %>_Aggravated_Soak}<% }); %>" disabled /></td>
                                <td class="item w50" ><input type='text' class="st" name='attr_Penalty' value="<% armorSlots.forEach((a, i) => { %><% if (i > 0) { %>+<% } %>@{Armor<%= a.id %>_Penalty}<% }); %>" disabled/></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="col">
				    <h3 class="category-title">Injuries</h3>
                    <table class="movement-table">
                        <thead>
                            <tr>
                                <th class="item w120">Injury</th>
                                <th class="item w50">Type</th>
                                <th class="item w50">Penalty</th>
                            </tr>
                        </thead>
                    </table>
                    <% injuryTypes.forEach(injury => { -%>
                    <div class="row">
                        <div class="item w120"><%= injury.name %></div>
                        <div class="item w50" >
                            <select class='select_wound' name='attr_<%= injury.name %>'>
                                <% woundOptions.forEach(opt => { -%>
                                <option><%= opt %></option>
                                <% });-%>
                            </select>
                        </div>
                        <div class="item w50" ><input type='text' class="select_wound" name='attr_<%= injury.name %>HealthPenalty' value=0 /></div>
                    </div>
				    <fieldset class='repeating_<%= injury.repeatingClass %>'>
                        <div class="row">
                            <div class="item w120">
                                <select class='select_wound' name='attr_rHealthName'>
                                    <option><%= injury.name %></option>
                                </select>
                            </div>
                            <div class="item w50" >
                                <select class='select_wound' name='attr_rHealthWound'>
                                    <% woundOptions.forEach(opt => { -%>
                                    <option><%= opt %></option>
                                    <% }); -%>
                                </select>
                            </div>
                            <div class="item w50" ><input type='text' class="select_wound" name='attr_<%= injury.name %>HealthPenalty' value=0 /></div>
                        </div>
                    </fieldset>
                    <% }); -%>
                    <h4>Extras</h4>
				    <fieldset class='repeating_health'>
                        <div class="row">
                            <div class="item w120">
                                <select class='select_wound' name='attr_rHealthName'>
                                    <% injuryTypes.forEach(injury => { -%>
                                    <option><%= injury.name %></option>
                                    <% }); -%>
                                    <option>Dead</option>
                                </select>
                            </div>
                            <div class="item w50" >
                                <select class='select_wound' name='attr_rHealthWound'>
                                    <% woundOptions.forEach(opt => { -%>
                                    <option><%= opt %></option>
                                    <% }); -%>
                                </select>
                            </div>
                            <div class="item w50" ><input type='text' class="select_wound" name='attr_rHealthPenalty' value=0 /></div>
                        </div>
                    </fieldset>
                    <div class="row">
                        <div class="item w120">Dead</div>
                        <div class="item w50" >
                            <select class='select_wound' name='attr_Dead'>
                                <% woundOptions.forEach(opt => { -%>
                                <option><%= opt %></option>
                                <% }); -%>
                            </select>
                        </div>
                        <div class="item w50" ><input type='text' class="select_wound" name='attr_DeadHealthPenalty' value=0 /></div>
                    </div>
                </div>
            </div>
		</div>
